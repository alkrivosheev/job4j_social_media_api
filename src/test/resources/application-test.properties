# ============================================
# Минимальный конфиг для тестов с Testcontainers
# Testcontainers сам подставит spring.datasource.url, username, password!
# ============================================
spring.liquibase.enabled=false
# 1. Отключаем banner и ненужные автоконфигурации
spring.main.banner-mode=off
# Если в тестах не нужна безопасность, можно ее отключить
# Если нужна - удалите эту строку
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration

# 2. Ключевые настройки для JPA/Hibernate + Liquibase
# НЕ указываем spring.datasource.* - их подставит @DynamicPropertySource!
# Диалект ОБЯЗАТЕЛЬНО меняем на PostgreSQL
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
# Для тестов часто используют create-drop или validate
# Если используете Liquibase - лучше оставить validate
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.open-in-view=false

# 3. НАСТРОЙКИ LIQUIBASE - САМОЕ ВАЖНОЕ!
# Включаем Liquibase, чтобы он применил миграции к тестовой БД из контейнера
#spring.liquibase.enabled=true
# Liquibase будет искать changelog по умолчанию: db/changelog/db.changelog-master.yaml
# Если у вас другое расположение, укажите явно:
# spring.liquibase.change-log=classpath:/db/changelog/db.changelog-master.yaml

# 4. Дополнительные настройки (опционально)
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN
logging.level.org.testcontainers=INFO
# Для отладки подключения к БД
# logging.level.org.springframework.jdbc.datasource=DEBUG

# Thymeleaf (если нужен в тестах)
spring.thymeleaf.check-template-location=false
spring.thymeleaf.cache=false